service TestService("test-service"):
    get_records(key: string) -> []string

func append_records(peer: string, srum: *[]string):
  srum <- TestService.get_records(peer)

func retrieve_records(peer: string) -> [][]string:
    records: *[]string
    append_records(peer, records)
    <- records

func useStream(stream: *string) -> *string:
    stream <<- "valueUseStream"
    <- stream

func returnStream() -> *string:
    r <- useStream(*[])
    r <<- "valueReturnStream"
    <- r

func lng280Bug() -> []string:
    stream <- returnStream()
    stream <<- "valueTop"
    <- stream

func lng280BugWithFor() -> []string:
    results: *string
    arr = [1,2,3]

    for a <- arr:
      stream <- returnStream()
      results <<- stream[0]
      results <<- stream[1]

    <- results

service StreamService("test-service"):
    store(strings: []u32)

func callService(stream: *u32, n: u32):
    StreamService.store(stream, a)

func lng280BugWithForAnonStream():
  arr = [1,2,3,4,5]
  for a <- arr:
    useStream(*[], a)
